---
title: "Taustatiedot"
layout: post
---

```{rkimpaleoption, echo=FALSE}
opts_chunk$set(echo=FALSE,eval=TRUE,fig.width=14,cache=TRUE,warning=FALSE,message=FALSE)
```


```{rLataaData}
# Lataa paketit
library(ggplot2) # Kuvioiden piirtoon
library(reshape2)
# 
library(foreign)
setwd("~/workspace/consulting/keva_main/jek1")
# dat <- read.spss(file="../keva/original/esimerkkidata.sav", 
#                  to.data.frame=TRUE)
# save(dat, file="../keva/original/dat.RData")
setwd("~/workspace/consulting/keva_main/jek1")
load(file="../keva/original/dat.RData")
# Manual colors
KevaPal <- c("#56B4E9", "#E69F00", "#999999", "#009E73", "#F0E442", "#0072B2","#D55E00", "#CC79A7")
```

Toimiala/osasto
-------------------

```{rToimiala}
tbl <- as.data.frame(prop.table(table(dat$VAR00008)) * 100)
tbl$Freq <- round(tbl$Freq,1)
#
ggplot(tbl, aes(x=reorder(Var1, Freq, max),
                y=Freq,
                label=Freq)) +
  geom_bar(stat="identity", fill="#56B4E9") +
  geom_text(hjust=-.1, color="grey40") +
  coord_flip(ylim=c(0,max(tbl$Freq)+5)) +
  labs(title="Kuvion otsikko",
       x="Osasto",
       y="prosenttia") +
  theme_minimal() +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40")) +
  theme(legend.title = element_blank())
  

```

Sukupuoli
------------------------

```{rSupu}
tbl <- as.data.frame(prop.table(table(dat$VAR00001)) * 100)
tbl$Freq <- round(tbl$Freq,1)
# lisataan koko maa
tbl$paikka <- "Siilinjärvi"
Freq <- c(16.0,84)
Var1 <- c("mies","nainen")
paikka <- c("Muu kuntasektori")
tbl2 <- data.frame(Var1,Freq,paikka)
tbl <- rbind(tbl,tbl2)
#
ggplot(tbl, aes(x=factor(paikka),
                y=Freq,
                fill=factor(Var1),
                label=Freq)) +
  geom_bar(stat="identity") +
  geom_text(position=position_stack(width=0.9),hjust=1) +  
  labs(title="Kuvion otsikko",
       x="Paikka",
       y="prosenttia") +
  coord_flip() +  
  theme_minimal() +
  theme(legend.position="top") +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40"))   +
  theme(legend.title = element_blank()) +
  scale_fill_manual(values=KevaPal)
```


Työ- tai virkasuhteesi luonne?
------------------------


```{rTyosuhde}
tbl <- as.data.frame(prop.table(table(dat$VAR00003)) * 100)
tbl$Freq <- round(tbl$Freq,1)
# lisataan koko ma
tbl$paikka <- "Siilinjärvi"
Freq <- c(85,15)
Var1 <- c("vakituinen","määräaikainen")
paikka <- c("Muu kuntasektori")
tbl2 <- data.frame(Var1,Freq,paikka)
tbl <- rbind(tbl,tbl2)
#
ggplot(tbl, aes(x=factor(paikka),
                y=Freq,
                fill=Var1,
                label=Freq)) +
  geom_bar(stat="identity") +
  geom_text(position=position_stack(width=0.9),hjust=1) +
  labs(title="Kuvion otsikko",
       x="Paikka",
       y="prosenttia") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position="top") +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40"))  +
  theme(legend.title = element_blank()) +
  scale_fill_manual(values=KevaPal)

```


Työsuhteen kesto nykyisellä työnantajalla?
-----------------------

```{rTyosuhdeKesto}
tbl <- as.data.frame(prop.table(table(dat$VAR00006)) * 100)
tbl$Freq <- round(tbl$Freq,1)
# lisataan koko ma
tbl$paikka <- "Siilinjärvi"
Freq <- c(6,16,23,55)
Var1 <- c("alle 1 vuoden","1-3 vuotta","4-10 vuotta","yli 10 vuotta")
paikka <- c("Muu kuntasektori")
tbl2 <- data.frame(Var1,Freq,paikka)
tbl <- rbind(tbl,tbl2)
#
ggplot(tbl, aes(x=factor(paikka),
                y=Freq,
                fill=Var1,
                label=Freq)) +
  geom_bar(stat="identity") +
  geom_text(position=position_stack(width=0.9),hjust=1) +
  labs(title="Kuvion otsikko",
       x="Paikka",
       y="prosenttia") +
  coord_flip() +
  theme_minimal() +
  theme(legend.position="top") +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40")) +
  theme(legend.title = element_blank())  +
  scale_fill_manual(values=KevaPal)

```

Korkein koulutuksesi?
-----------------------

```{rKoulutus}
tbl <- as.data.frame(prop.table(table(dat$VAR00004)) * 100)
tbl$Freq <- round(tbl$Freq,1)
# lisataan koko ma
tbl$paikka <- "Siilinjärvi"
Freq <- c(7,2,37,21,7,7,19)
Var1 <- c("peruskoulu / kansakoulu / keskikoulu",
          "lukio (keskiaste)",
          "ammatillinen tutkinto (kouluaste)",
          "opistoasteen tutkinto (opistoaste)",
          "ammattikorkeakoulututkinto",
          "alempi korkeakoulututkinto",
          "ylempi korkeakoulututkinto")
tbl2 <- data.frame(Var1,Freq)
tbl2$paikka <- "Muu kuntasektori"
tbl <- rbind(tbl,tbl2)
#
ggplot(tbl, aes(x=factor(Var1),
                y=Freq,
                fill=paikka,
                label=Freq)) +
  geom_bar(stat="identity",position="dodge") +
  geom_text(position=position_dodge(width=0.9),hjust=1) +
  labs(title="Kuvion otsikko",
       x="Paikka",
       y="prosenttia") +
  coord_flip() +  
  theme_minimal() +
  theme(legend.position="top") +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40")) +
  theme(legend.title = element_blank())  +
  scale_fill_manual(values=KevaPal)

```


Toimitko esimiesasemassa?
-------------------

```{rEsimiesasema}
tbl <- as.data.frame(prop.table(table(dat$VAR00005)) * 100)
tbl$Freq <- round(tbl$Freq,1)
# lisataan koko ma
tbl$paikka <- "Siilinjärvi"
Freq <- c(12,88)
Var1 <- c("kyllä","en")
tbl2 <- data.frame(Var1,Freq)
tbl2$paikka <- "Muu kuntasektori"
tbl <- rbind(tbl,tbl2)
#
ggplot(tbl, aes(x=factor(paikka),
                y=Freq,
                fill=Var1,
                label=Freq)) +
  geom_bar(stat="identity") +
  geom_text(position=position_stack(),hjust=1) +
  labs(title="Kuvion otsikko",
       x="Paikka",
       y="prosenttia") +
  coord_flip()  +
  theme_minimal() +
  theme(legend.position="top") +
  theme(text=element_text(color="grey40",size=20)) +
  theme(axis.ticks= element_line(color="grey40")) +
  theme(legend.title = element_blank())  +
  scale_fill_manual(values=KevaPal)

```
